<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Dashboard</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Poppins', sans-serif;
      min-height: 100vh;
      background:
        linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)),
        url("https://images.unsplash.com/photo-1524995997946-a1c2e315a42f");
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }

    .navbar {
      background: linear-gradient(90deg, #2a9d8f, #52b788);
    }

    .navbar-brand {
      font-weight: 600;
      color: #fff !important;
    }

    .welcome-text {
      color: #fff;
      font-weight: 600;
    }

    .card-box {
      background: rgba(255,255,255,0.95);
      border-radius: 15px;
      transition: all 0.3s ease;
    }

    .card-box:hover {
      transform: translateY(-6px);
      box-shadow: 0 12px 30px rgba(0,0,0,0.25);
    }

    .icon-box {
      font-size: 35px;
      margin-bottom: 10px;
    }

    .logout-btn {
      background: #e63946;
      border: none;
    }

    .logout-btn:hover {
      background: #c1121f;
    }

    .table-card {
      background: rgba(255,255,255,0.95);
      border-radius: 15px;
      box-shadow: 0 12px 30px rgba(0,0,0,0.25);
    }
  </style>
</head>

<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg">
  <div class="container-fluid">
    <span class="navbar-brand">
      ðŸ“š DRK Library â€“ Student Panel
    </span>
    <div>
      <a href="/student/change-password" class="btn btn-light btn-sm me-2">
        Change Password
      </a>
      <a href="/student/logout" class="btn btn-sm logout-btn text-white">
        Logout
      </a>
    </div>
  </div>
</nav>

<!-- DASHBOARD -->
<div class="container mt-4">

  <h4 class="welcome-text">
    Welcome, <%= student.name %> ðŸ‘‹
  </h4>

  <!-- SUMMARY CARDS -->
  <div class="row g-4 mt-3">

    <div class="col-md-4">
      <div class="card card-box text-center p-4">
        <div class="icon-box text-primary">
          <i class="bi bi-book"></i>
        </div>
        <h5>Issued Books</h5>
        <h3><%= records.length %></h3>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card card-box text-center p-4">
        <div class="icon-box text-success">
          <i class="bi bi-calendar-check"></i>
        </div>
        <h5>Active Books</h5>
        <h3>
          <%= records.filter(r => r.status === "Issued").length %>
        </h3>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card card-box text-center p-4">
        <div class="icon-box text-danger">
          <i class="bi bi-cash-coin"></i>
        </div>
        <h5>Total Fine</h5>
        <h3>
          â‚¹<%= records.reduce((sum, r) => sum + r.fine, 0) %>
        </h3>
      </div>
    </div>

  </div>

  <!-- ISSUED BOOKS TABLE -->
  <div class="table-card mt-4">
    <div class="card-header bg-dark text-white rounded-top">
      Issued Books Details
    </div>

    <div class="card-body">
      <table class="table table-bordered table-striped mb-0">
        <thead class="table-dark">
          <tr>
            <th>Book</th>
            <th>Issue Date</th>
            <th>Due Date</th>
            <th>Status</th>
            <th>Fine (â‚¹)</th>
          </tr>
        </thead>
        <tbody>
          <% records.forEach(r => { %>
            <tr>
              <td><%= r.book_name %></td>
              <td><%= r.issue_date %></td>
              <td><%= r.due_date %></td>
              <td>
                <span class="badge <%= r.status === 'Issued' ? 'bg-warning' : 'bg-success' %>">
                  <%= r.status %>
                </span>
              </td>
              <td><%= r.fine %></td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </div>

</div>

</body>
</html>
